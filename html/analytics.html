
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>newsletter</title>
    <link rel="stylesheet" href="css/libs/clay.css"> 

    <link rel="stylesheet" href="css/libs/main.css">
 <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">    
    <link rel="stylesheet" href="css/libs/treeJS.css">
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/libs.js"></script>

 
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui@2.6.1/lib/index.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
    <!-- vue-highcharts should be load after Highcharts -->
    <script src="https://cdn.jsdelivr.net/npm/vue-highcharts/dist/vue-highcharts.min.js"></script>

    

    

</head>

<body>

    <div class="cims" id="wrapper">
        <header class="header">
            <div class="container-fluid">
                <nav class="main-nav navbar-expand-lg navbar-light">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="main-logo">
                        <img class="main-logo__img" src="images/logoCims.png" alt="CIMS logo">
                        <span class="main-logo__name">CIMS</span>
                    </div>
                    <div class="navbar-collapse collapse main-nav__navigation" id="navbarSupportedContent">
                        <div class="main-nav__section main-nav__section--left">
                            
                            <ul class="main-nav__list">
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="organisation-selection.html">Home</a>
                                </li>
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="index.html">Messages</a>
                                </li>
                            </ul>

                        </div>

                        <div class="main-nav__section main-nav__section--right">

                            <ul class="main-nav__list">
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="message-editor.html">New Message</a>
                                </li>
                                <li class="main-nav__item">
                                    <div class="header-dropdown">
                                        <span data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-display="static">
                                            <a data-cq-component="link" href="#" target="_self" class="main-nav__link caret active">Administrator</a>
                                        </span>

                                        <div class="header-dropdown__inner dropdown-menu" role="menu">
                                            <ul class="header-submenu">
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="categories-editor.html">Categories</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="ressource-editor.html">Resources</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="organisation-settings.html">Organisation Settings</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="translation.html">Translation</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="rules.html">Rules</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="feeds.html">Feeds</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="mandatory-categories.html">Mandatory categories</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="message-preferences.html">Message preferences</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link active" href="newsletter.html">Newsletter</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="auditing.html">Auditing</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="konzerne.html">Konzerne</a>
                                                    </li>

                                            </ul>
                                        </div>

                                    </div>
                                </li>
                                <li class="main-nav__item">
                                    <a class="main-nav__link" href="#">Sign Out</a>
                                </li>
                            </ul>
                        
                        </div>
                    </div>
                </nav>
            </div>
        </header>
        <main>

            <div class="container-fluid" id="app">
                <div class="analytics">             
                    <el-tabs class="analytics-dashbord" v-model="dashboardsValue" type="card" @tab-remove="removeDashbord">
                        <el-tab-pane closable 
                            v-for="(item, index) in dashboards"
                            :key="item.name"
                            :label="item.title"
                            :name="item.name"
                        >
                        <span class="analytics-dashbord__tab-name" slot="label">
 {{item.title}} 
                            <div class="analytics-dashbord__edit-name" @click="editTabName(item.title, index)">
                                edit
                            </div>
                        </span>
{{item.content}} 
                            <div class="charts" v-for="chart in item.charts">
                                <div class="charts__container" ref="test">
                                    <div class="chart__item">
                                        <div class="chart__header">
                                            <ul class="chart-list chart-list--left">
                                                <li class="chart-list__item"  v-bind:class="{ active : chart.isPanelActive }" v-on:click="togglePanel('isPanelActive', index, chart.id)">
                                                    <i class="fas fa-filter"></i>
                                                </li>
                                                <li class="chart-list__item" v-bind:class="{ active : chart.isPanelActive2 }" v-on:click="togglePanel('isPanelActive2', index, chart.id)">
                                                    <i class="fas fa-cog"></i>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="fas fa-sort-amount-down"></i>
                                                    <el-select class="analytics-select" v-model="chartSorting" placeholder="Select">
                                                        <el-option
                                                          v-for="item in chartSortingOptions"
                                                          :key="item.value"
                                                          :label="item.label"
                                                          :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="far fa-chart-bar"></i>
                                                    <el-select class="analytics-select" v-model="chartType" placeholder="Select">
                                                        <el-option
                                                          v-for="item in chartTypeOptions"
                                                          :key="item.value"
                                                          :label="item.label"
                                                          :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </li>
                                            </ul>
                                            <ul class="chart-list chart-list--right">
                                                <li class="chart-list__item">
                                                    <i class="fas fa-download"></i>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="fas fa-trash"></i>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="chart__body">
                                            <!-- start panel -->
                                            <div class="chart__panels">
                                                <div class="filters-panel filters-panel--small" v-bind:class="{ active : chart.isPanelActive }">
                                                    <div class="filters-panel__btn" v-bind:class="{ active : chart.isPanelActive }"
                                                    v-if="isPanelActive" v-on:click="togglePanel('isPanelActive1', index, chart.id)">
                                                        <span>&nbsp;</span>
                                                        <span class="collapse-icon-closed">
                                                            <i class="fas fa-chevron-left"></i>
                                                        </span>
                                                        <span class="collapse-icon-open">
                                                            
                                                        </span>
                                                        <span class="search-mobile">
                                                            <i class="fas fa-search"></i>
                                                        </span>
                                                    </div>
                                                    <div class="filters-panel__body">
                                                        <form>
                                                            <!-- SEARCH & FILTER STARTS -->
                                    
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">search_and_filter
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-7 offset-4">
                                                                            <div class="select-container">
                                                                                <el-select v-model="selectedUserFilter"
                                                                                            >
                                                                                    <el-option
                                                                                            v-for="opt in savedUserFilters"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div class="open-icon" aria-expanded="true" v-on:click="openFilterListDlg">
                                                                                <i class="fas fa-cog"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="textFilterBody"
                                                                   aria-expanded="true" data-toggle="collapse" href="#textFilterBody" id="textFilter"
                                                                   role="tab">
                                                                    <span class="filter-category__title">text_and_period_filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                                        <i class="fas fa-chevron-down"></i>
                                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                                        <i class="fas fa-chevron-up"></i>
                                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">posted</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateChangeOptions.rangeSeparator == '-'"></span>
                                                                                        <div v-if="dateChangeOptions.rangeSeparator != '-'" style="margin-left: -60px;"></div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                                                        </div>
                                    
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">text_search</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->
                                                            <!-- copy paste -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="textFilterBody"
                                                                    aria-expanded="true" data-toggle="collapse" href="#textFilterBody" id="textFilter"
                                                                    role="tab">
                                                                    <span class="filter-category__title">text_and_period_filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                                        <i class="fas fa-chevron-down"></i>
                                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                                        <i class="fas fa-chevron-up"></i>
                                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                        id="textFilterBody" role="tabpanel">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">posted</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateChangeOptions.rangeSeparator == '-'"></span>
                                                                                        <div v-if="dateChangeOptions.rangeSeparator != '-'" style="margin-left: -60px;"></div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                                                        </div>
                                    
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">text_search</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                    placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- copy paste ends -->
                                                            <!-- copy paste -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="textFilterBody"
                                                                    aria-expanded="true" data-toggle="collapse" href="#textFilterBody" id="textFilter"
                                                                    role="tab">
                                                                    <span class="filter-category__title">text_and_period_filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                                        <i class="fas fa-chevron-down"></i>
                                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                                        <i class="fas fa-chevron-up"></i>
                                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                        id="textFilterBody" role="tabpanel">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">posted</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateChangeOptions.rangeSeparator == '-'"></span>
                                                                                        <div v-if="dateChangeOptions.rangeSeparator != '-'" style="margin-left: -60px;"></div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                                                        </div>
                                    
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">text_search</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                    placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- copy paste ends -->
                                                            <!-- copy paste -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="textFilterBody"
                                                                    aria-expanded="true" data-toggle="collapse" href="#textFilterBody" id="textFilter"
                                                                    role="tab">
                                                                    <span class="filter-category__title">text_and_period_filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                                        <i class="fas fa-chevron-down"></i>
                                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                                        <i class="fas fa-chevron-up"></i>
                                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                        id="textFilterBody" role="tabpanel">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">posted</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateChangeOptions.rangeSeparator == '-'"></span>
                                                                                        <div v-if="dateChangeOptions.rangeSeparator != '-'" style="margin-left: -60px;"></div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                                                        </div>
                                    
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">text_search</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                    placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- copy paste ends -->
                                                        
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link" value="save" v-on:click="openFilterDlg">
                                                                    <i class="fas fa-save"></i>
                                                                    save_filter
                                                                </a>
                                                            </div>
                                    
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link" value="reset"
                                                                   v-on:click="clearFilters($event)">
                                                                    <i class="far fa-trash-alt"></i>
                                                                    reset
                                                                </a>
                                                                <a href="javascript:void(0)" class="btn-link btn-link--primary"
                                                                   v-on:click="doSearch($event)">
                                                                    <i class="fas fa-search"></i>
                                                                    submit
                                                                </a>
                                                            </div>
                                    
                                                        </form>
                                                    </div>
                                                </div>
                                                <!-- ends panel -->
                                                <div class="filters-panel filters-panel--small" v-bind:class="{ active : chart.isPanelActive2 }">
                                                    <div class="filters-panel__body">
                                                        <form>
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Breakdown by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Select categories to be shown on the Y-Axis:</p>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Breakdown"
                                                                            inactive-text="Summarize">
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Category</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>

                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Sort by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.typeSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.typeSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.viewSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.viewSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.orderSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.orderSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.value"
                                                                                            :value="opt.value">
                                                                                    </el-option>
                                                                            </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">List Results (0 = All):</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <el-input v-model="yAxis.linitResults" class="full-width input-small"></el-input>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">What to count?</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue"
                                                                                            >
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Delta vs. previous period"
                                                                            >
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Limit count to the following categories:</p>
                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Chart title</p>
                                                                    <div class="filter-category__item">
                                                                        <el-input v-model="yAxis.linitResults" placeholder="Title" class="full-width input-small"></el-input>
                                                                    </div>
                                                                    <div class="filter-category__item">
                                                                        <el-input v-model="yAxis.linitResults" placeholder="Subtitle" class="full-width input-small"></el-input>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link btn-link--primary"
                                                                   v-on:click="doSearch($event)">
                                                                    <i class="fas fa-search"></i>
                                                                    submit
                                                                </a>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="chart-container" v-bind:style="chart.chartHeight" :ref="'settingsBox' + chart.id" v-bind:class="{ active: chart.isPanelActive2 || chart.isPanelActive }">

                                                <highcharts :ref="'myChart' + chart.id" class="chart__graph" :options="options" ref="highcharts"></highcharts>

                                            </div>
                                            <div class="chart__panels chart__panels--bottom" >
                                                <div class="filters-panel filters-panel--bottom" :ref="'panelBottom' + chart.id" v-bind:class="{ active: chart.isPanelActive2 }">
                                                    <div class="filters-panel__body">
                                                        <form class="form-inline">
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Breakdown by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">

                                                                            <label class="filter-category__label">Breakdown by:</label>


                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>


                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Select categories to be shown on the Y-Axis:</p>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Breakdown"
                                                                            inactive-text="Summarize">
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Category</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>

                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-5">
                                                                            <label class="filter-category__label">List Results (0 = All):</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <el-input v-model="yAxis.linitResults" class="full-width input-small"></el-input>
                                                                        </div>
                                                                    </div>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-5">
                                                                            <label class="filter-category__label">Sort by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.typeSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.typeSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.viewSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.viewSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.orderSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.orderSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.value"
                                                                                            :value="opt.value">
                                                                                    </el-option>
                                                                            </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </el-tab-pane>
                        <el-tab-pane  v-if="dashboards.length !== 0" :name="`${(tabIndex + 1).toString()}`"> 
                                <span class="add-test" slot="label" @click="addNewDashbord(tabIndex)">
                                    <i class="far fa-plus-square"></i>
                                </span>
                        </el-tab-pane>
                    </el-tabs>

                    <div class="btn-analytics" @click="addNewDashbord(dashboardsValue)"><span class="btn-analytics__title">Add chart</span></div>

                </div>

                <el-dialog title="Category popup" :visible.sync="dlgTabName"
                           custom-class="category-popup">
                    <div class="dialog-body">
                        <el-input
                            class="input-small"
                            v-model="editTitle"
                        ></el-input>
                    </div>
                    <div slot="footer" class="dialog-footer">
                        <el-button size="small" @click="dlgTabName = false">
                            Cancel
                        </el-button>
                        <el-button size="small" type="primary" @click="saveTabName">
                            Confirm
                        </el-button>
                    </div>
                </el-dialog>
            </div>


        </main>

        <footer class="footer">
            <div class="container-fluid">
                <p class="footer__copyright"> Copyright 2018 Consline AG</p>
            </div>
        </footer>
        
    </div>


    <!-- SCRIPTS -->
 
<script type="text/babel">

class DateRangePickerOptions {
    constructor() {
        this.dateInCalcRule = -1;
        this.dateInFormat = 'dd.MM.yyyy';
        this.rangeSeparator = '-';
        var thisObj = this;

        this.onPick = function (dates) {
            thisObj.dateInCalcRule = -1;
            thisObj.rangeSeparator = '-';
            thisObj.dateInFormat = 'dd.MM.yyyy';
        };

        this.shortcuts = [
            {
                text: 'Last 7 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 7;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 7 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last 14 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 14;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 14 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last 30 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 30;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 30 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Month',
                onClick(picker) {
                    thisObj.dateInCalcRule = 31;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Quarter',
                onClick(picker) {
                    thisObj.dateInCalcRule = 90;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Year',
                onClick(picker) {
                    thisObj.dateInCalcRule = 365;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }
        ];
    }

    static calcRangeByRule(prmCalcRule, prmMinDefault, prmMaxDefault) {
        switch (prmCalcRule) {
            case -1: return [ prmMinDefault, prmMaxDefault ];
            case 365: {
                var targetYear = new Date();
                targetYear.setFullYear(targetYear.getFullYear() - 1);
                var startDate = new Date(targetYear.getFullYear(), 0, 1);
                var endDate = new Date(targetYear.getFullYear(), 12, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 90: {
                var targetMonth = new Date();
                targetMonth.setMonth(targetMonth.getMonth() - 3);
                var targetQuater = parseInt((targetMonth.getMonth() + 1) / 3) + 1;
                var startDate = new Date(targetMonth.getFullYear(), 0 + (targetQuater - 1) * 3, 1);
                var endDate = new Date(targetMonth.getFullYear(), 3 + (targetQuater - 1) * 3, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 31: {
                var targetMonth = new Date();
                targetMonth.setMonth(targetMonth.getMonth() - 1);
                var startDate = new Date(targetMonth.getFullYear(), targetMonth.getMonth(), 1);
                var endDate = new Date(targetMonth.getFullYear(), targetMonth.getMonth() + 1, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 30: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 29);
                return [date, now];
            };
            case 14: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 13);
                return [date, now];
            };
            case 7: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 6);
                return [date, now];
            }
        }
    }

    onChange (e) {
        if (e == null) {
            this.rangeSeparator = '-';
            this.dateInFormat = 'dd.MM.yyyy';
        } else {

        }
        console.log('changed');
    }
}






var options = {
    title: {
        text: 'Title of this chart'
        },
    legend: {
    enabled: false
    },
    credits: {
    enabled: false
    },
    tooltip: {
    positioner: function(labelWidth, labelHeight, point) {
        var seriesPoints = this.chart.series[0].points,
        indexValue, tooltipX, tooltipY;

        seriesPoints.forEach(function(el, inx) {
        if ((point.plotX === Math.round(el.plotX)) && (point.plotY === Math.round(el.plotY))) {
            indexValue = inx;
        }
        });

        tooltipX = point.plotX;
        tooltipY = this.chart.chartHeight - this.chart.plotTop - this.chart.xAxis[0].bottom;

        if (indexValue === 0) {
        tooltipX += this.chart.plotLeft;
        }

        return {
        x: tooltipX,
        y: tooltipY
        };
    },
    shadow: false,
    borderWidth: 1,
    backgroundColor: 'rgba(255,255,255,0.8)'
    },
    xAxis: {
    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },
    series: [{
    data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
    }],
    //exporting: {
    //    showTable: true
    //}
}
Vue.use(VueHighcharts);

new Vue({
    el: "#app",
    data: function() {
        return {
            selectedUserFilter: '',
            savedUserFilters: [{name: 'filter1', id: 1},{name: 'filter2', id: 2},{name: 'filter3', id: 3}],

            chartSorting: '',
            chartSortingOptions: [{label: 'Sort by categories (ascending)', value: 'cat,asc'}, {label: 'Sort by categories (descending)', value: 'cat,desc'},
                {label: 'Sort by total (ascending)', value: 'total,asc'}, {label: 'Sort by total (descending)', value: 'total,desc'},
                {label: 'Sort by negatives (ascending)', value: 'negatives,asc'}, {label: 'Sort by negatives (descending)', value: 'negatives,desc'},
                {label: 'Sort by neutrals (ascending)', value: 'neutrals,asc'}, {label: 'Sort by neutrals (descending)', value: 'neutrals,desc'},
                {label: 'Sort by positives (ascending)', value: 'positives,asc'}, {label: 'Sort by positives (descending)', value: 'positives,desc'},
            ],
            chartType: '',
            chartTypeOptions: [{label: 'Column Chart', value: 'column_chart'}, {label: 'Percentage Chart', value: 'percentage_chart'},
                {label: 'Bar Chart', value: 'bar_chart'}, {label: 'Bar Chart (Percentage)', value: 'bar_chart_percentage'},
                {label: 'Pie Chart', value: 'pie_chart'}, {label: 'Data table', value: 'data_table'},
            ],

            options: options,
            panels: ['isPanelActive', 'isPanelActive2'],
            isPanelActive: false,
            isPanelActive2: true,
            xAxis: {

            },
            yAxis: {
                breakdown: [{name: 'Tonality', id: 1},{name: 'Categories', id: 2},{name: 'Total', id: 3},{name: 'Worldmap', id: 4},],
                breakdownValue: '',
                toggleControl: '',
                linitResults: '',
                typeSorting: '',
                typeSortingOptions: [{label: "Category", id: 1}, {label: "Total", id: 2}, {label: "Positive", id: 3}, {label: "Neutral", id: 4}, {label: "Negative", id: 5}],
                viewSorting: '',
                viewSortingOptions: [{label: "Absolute", id: 1}, {label: "Relative / Percentage", id: 2}],
                orderSorting: '',
                orderSortingOptions: [{label: "Descending", value: "desc"}, {label: "Ascending", value: "asc"},],
            },
            filter: {
                keywords: '',
            },
            dateChangeOptions: new DateRangePickerOptions(),
            tabIndex: 0,
            dlgTabName: false,
            editTitle: '',
            editTitleIndex: null,

            dashboardsValue: '1',
            dashboards: [
                {
                    title: 'New Chart 1',
                    name: '1',
                    content: 'New Chart 1',
                    charts: [
                        {
                            id: 1,
                            panels: ['isPanelActive', 'isPanelActive2'],
                            isPanelActive: false,
                            isPanelActive2: false,
                            chartHeight: {},
                        }
                    ]
                },
            ],
            tabIndex: 1
        }
    },
    methods: {
        addNewDashbord: function(targetName) {
            console.log(this.tabIndex)
            let newDashbordName = ++this.tabIndex + '';
            const title = `New chart ${this.tabIndex}`
            this.dashboards.push({
                title: title,
                name: newDashbordName,
                content: 'New Tab content',

            });
            
            this.dashboardsValue = newDashbordName;
        },
        removeDashbord: function(targetName) {
            let tabs = this.dashboards;
            let activeName = this.dashboardsValue;
            console.log(targetName, activeName)
            if (activeName === targetName) {
                tabs.forEach((tab, index) => {
                    if (tab.name === targetName) {
                        console.log(tab.name)
                        let nextTab = tabs[index + 1] || tabs[index - 1];
                        if (nextTab) {
                            activeName = nextTab.name;
                        }
                    }
                });
            }
            
            this.dashboardsValue = activeName;
            this.dashboards = tabs.filter(tab => tab.name !== targetName);
        },
        editTabName: function(name,index) {
            console.log(name)
            this.editTitle = name;
            this.editTitleIndex = index;
            this.dlgTabName = true;
        },
        saveTabName: function() {
            this.dashboards[this.editTitleIndex].title = this.editTitle;
            console.log(this.editTitleIndex)
            this.dlgTabName = false;
            document.getElementById(`tab-${this.editTitleIndex + 1}`).focus()
        },
        openFilterListDlg: function() {
            console.log('1')
        },
        openFilterDlg: function() {
            console.log(1)
        },
        togglePanel: function(panelName, dashboardIndex, chartIndex) {
            const currentChart =  this.dashboards[dashboardIndex].charts[1 - chartIndex];
            const box = this.$refs[`settingsBox${chartIndex}`][0];
            const chartBox = this.$refs[`myChart${chartIndex}`][0];
            console.log(box, chartBox)
            const chart = chartBox.chart;
            const bottomPanel = this.$refs[`panelBottom${chartIndex}`][0];
            console.log(bottomPanel)
            currentChart.panels.forEach((function(e) {
                if (e === panelName) {
                    currentChart[panelName] = !currentChart[panelName]
                } else {
                    currentChart[e] = false
                    
                }
            }).bind(this))
            console.log(bottomPanel.clientHeight)
            let panelHeight
            const that = this

            setTimeout(function() {
                /*const heightString = that.$refs.settingsBox[0].clientWidth;
                that.$refs.myChart[0].chart.setSize(null, 300)*/
                if (currentChart.isPanelActive2) {
                    panelHeight = bottomPanel.clientHeight;
                    console.log(box)
                    Vue.set(currentChart.chartHeight, 'height', `600px`);
                    chart.setSize(null, null)
                } else {
                    Vue.set(currentChart.chartHeight, 'height', '100%');
                    chart.setSize(null, null)
                }
                const heightString = box.clientWidth
                
                
            }, 400)
        }
    }
}); 
    </script>
    <script src="js/main.js"></script>
</body>
</html>