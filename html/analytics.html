
<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>newsletter</title>
    <link rel="stylesheet" href="css/libs/clay.css"> 

    <link rel="stylesheet" href="css/libs/main.css">
 <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">    
    <link rel="stylesheet" href="css/libs/treeJS.css">
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/libs.js"></script>

 
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui@2.6.1/lib/index.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
    <!-- vue-highcharts should be load after Highcharts -->
    <script src="https://cdn.jsdelivr.net/npm/vue-highcharts/dist/vue-highcharts.min.js"></script>

    <script type="text/javascript">
	var cimsUserLang = 'en_US';
	var cimsDict =
			{"en":[["miscellanous_cloud","Show tagcloud"],["workflow","Workflow"],["add_status","add status"],["edit_status","edit status"],["delete_status","delete status"],["msg_status","Message status"],["Select_category","Select category"],["Open_any_message_and_copy_URL","Open any message and copy URL, starting from http, ending before &msgid"],["never","never"],["Session_timeout_warning","Session timeout warning"],["Session_timeout","Session timeout"],["Add_new_Categories","Add new Categories"],["Please_insert_the_default_landing_page","Please insert the default landing page for multi-organization users."],["Messages","Messages"],["Available_statuses","Available statuses"],["Add_new_status","Add new status"],["Languages","Languages"],["Workflow","Workflow"],["Categories","Categories"],["Sources","Sources"],["URL","URL"],["translated","translated"],["File","File"],["Original title required","Original title required"],["Translation title required","Translation title required"],["mandatory_categories","Mandatory categories"],["revoke_categories","Revoke categories"],["add_revoke","Add revoke"],["add_mandatory","Add mandatory"],["translate","Translate:"],["Hide_tagcloud","Hide tagcloud"],["miscellaneous_filter","miscellaneous filter"],["note_email_address_is_optional","Please note: Entering an email address is optional. If you enter an email adress you will receive a notification if the specified filter conditions are met by a newly added message."],["Select","Select"],["search_and_filter","search & filter"],["extended_text_search","extended text search"],["category_filter","category filter"],["admin_filter","admin filter"],["miscellanous_filter","miscellanous filter"],["save_filter","Save filter"],["reset","Reset"],["submit","Submit"],["mark_all_messages","Mark all messages"],["export_filtered","Export filtered"],["delete_marked","Delete marked"],["text_and_period_filter","text & period filter"],["deactivate_or_reactive_org","Deactivate or Reactive organization (Assets will remail in the Database)"],["cancel","Cancel"],["confirm","Confirm"],["edit","Edit"],["history","History"],["delete_only_messages","Delete only messages in the following timeframe"],["publish_marked","Publish marked"],["posted","Posted"],["text_search","Text Search"],["field","Field"],["search_term","Search Term"],["category","Category"],["created","Created"],["end_date","End date:"],["tags","tags"],["rating","rating"],["delete_complete_org","Delete complete organization (including all messages, categories and sources)"],["changed","Changed"],["feed","Feed"],["user","User"],["status","Status"],["source","Source"],["marked","Marked"],["publish","Publish"],["multi_assignment","Multi assignment"],["add_extended_group","Add Extended Group"],["remove_extended_group","Remove Extended Group"],["add_filter_group","Add Filter Group"],["remove_filter_group","Remove Filter Group"],["close","Close"],["add_to_all_filtered","Add to all filtered messages"],["remove_from_all_filtered","Remove from all filtered messages"],["rules","Rules"],["indexing","Indexing"],["save_rule","Save rule"],["type","Type:"],["id","id:"],["save_and_close","Save & Close"],["save","Save"],["expand_all","expand all"],["collapse_all","collapse all"],["delete","Delete"],["add_new","Add new"],["select_file","Select file"],["org_settings","Organizations settings"],["regular-org","regular-organization"],["resource","Resource:"],["expiration_days","Expiration Days:"],["message_default_url","Message Default URL:"],["new_root_cat","New Root-Category:"],["new_root_res_cat","New Root-Resource-Category:"],["new_res_exp_days","New Resource-Expriration Days:"],["redirect_settings","Redirect settings"],["save_default_login_redirect","Save Default Login Redirect"],["fast_indexing","fast indexing (avoid status editing of messages)"],["index_uncategorized","index uncategorized"],["start_date","Start date:"],["start","Start"],["save_and_next","Save & Next"],["copy_message","Copy message"],["date","Date:"],["views","Views:"],["url","Url:"],["file","File:"],["original","Original:"],["author","Author:"],["message","message"],["original_title","Original Title:"],["translation","translation"],["translate_now","Translate now"],["title","Title:"],["selected_categories","selected categories"],["recently_used","recently used (ai suggestions)"],["add_marked_to_newsletter","Add marked to newsletter"],["add_tonality","Add Tonality"],["show_translation","Show Translation"],["show_html_source","Show html source"],["and","And"],["or","Or"],["exclude","Exclude"],["contains","Contains"],["not_contains","Not contains"],["delete_saved_filter","Delete saved filter"],["note_email_adress_is_optional","Please note: Entering an email adress is optional. If you enter an email adress you will receive a notification if the specified filter conditions are met by a newly added message."],["show_filters","Show filters"],["select_saved_filter","Select saved filter"],["select_users","Select Users"],["search_category","Search category"],["select_source","Select source"],["search_title_or_message","Search title or message"],["category_tree","Category Tree"],["source_tree","Source Tree"],["assigned_rules","Assigned rules:"],["category_type","Category type"],["Rating","Rating"],["Tagging","Tagging"],["TOP","TOP"],["select_date_and_time","Select date and time"],["translate_to","Translate to:"],["ai_suggestions","ai suggestions"],["shortcuts","shortcuts"],["regular_org","regular organization"],["Sort by date (descending)","Sort by date (descending)"],["per_page","per page"],["Sort by date (ascending)","Sort by date (ascending)"],["Sort by views (descending)","Sort by views (descending)"],["Sort by views (ascending)","Sort by views (ascending)"],["Original title","Original title"],["Translated title","Translated title"],["Short description original","Short description original"],["Short description translated","Short description translated"],["Any","Any"],["Unpublished","Unpublished"],["Published","Published"],["Open","Open"],["In Progress","In Progress"],["Resolved","Resolved"],["Reopened","Reopened"],["Closed","Closed"],["language_short","en"],["sources","sources"],["categories","categories"],["New Message","New Messages"],["Date create is required","Date create is required"],["Source site required","Source site required"],["URL required","URL required"],["selected_messages","Selected messages"],["delete_messages","You are going to delete"],["reset_all_selections","Reset All Selections"],["newsletter","Newsletter"],["email_receiver","Email receiver"],["subject","Subject"],["freetext","Freetext"],["send","Send"],["my_groups","My groups"],["select_group","Select group"],["new_group","New group"],["add_new_group","Add new group"],["feed_category","Feed Category"],["new_feed_category","New Feed Category"],["name","Name"],["options","Options"],["new_messages","New messages"],["new_feed_name","New Feed Name"],["edit_feed_name","Edit Feed Name"],["delete_organization_confirm","Are you sure you want to delete organization"],["select_all","Select All"]]};
	var cimsEnLocale = new Map(cimsDict.en);
	var cimsLocale = new Map((cimsDict.lc) ? cimsDict.lc : []);

	function cimsTranslate(e) {
		let elms = document.getElementsByClassName('text-translate');
		for (let e of elms) {
			let key = e.getAttribute('data-translate');
			if (key) {
				e.textContent = getLocaleCimsText(key);
			}
		}
	};

	if(window.attachEvent) {
		window.attachEvent('onload', cimsTranslate);
	} else {
		if(window.onload) {
			let curronload = window.onload;
			let newonload = function(evt) {
				curronload(evt);
				cimsTranslate(evt);
			};
			window.onload = newonload;
		} else {
			window.onload = cimsTranslate;
		}
	}

	function getLocaleCimsText(key) {
		let val = cimsLocale.get(key);
		val = (val) ? val : cimsEnLocale.get(key);
		return (val) ? val : key;
	}

</script>

    

</head>

<body>

    <div class="cims" id="wrapper">
        <header class="header">
            <div class="container-fluid">
                <nav class="main-nav navbar-expand-lg navbar-light">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="main-logo">
                        <img class="main-logo__img" src="images/logoCims.png" alt="CIMS logo">
                        <span class="main-logo__name">CIMS</span>
                    </div>
                    <div class="navbar-collapse collapse main-nav__navigation" id="navbarSupportedContent">
                        <div class="main-nav__section main-nav__section--left">
                            
                            <ul class="main-nav__list">
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="organisation-selection.html">Home</a>
                                </li>
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="index.html">Messages</a>
                                </li>
                            </ul>

                        </div>

                        <div class="main-nav__section main-nav__section--right">

                            <ul class="main-nav__list">
                                <li class="main-nav__item">
                                    <a class="main-nav__link " href="message-editor.html">New Message</a>
                                </li>
                                <li class="main-nav__item">
                                    <div class="header-dropdown">
                                        <span data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle" data-display="static">
                                            <a data-cq-component="link" href="#" target="_self" class="main-nav__link caret active">Administrator</a>
                                        </span>

                                        <div class="header-dropdown__inner dropdown-menu" role="menu">
                                            <ul class="header-submenu">
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="categories-editor.html">Categories</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="ressource-editor.html">Resources</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="organisation-settings.html">Organisation Settings</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="translation.html">Translation</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="rules.html">Rules</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="feeds.html">Feeds</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="mandatory-categories.html">Mandatory categories</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="message-preferences.html">Message preferences</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link active" href="newsletter.html">Newsletter</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="auditing.html">Auditing</a>
                                                    </li>
                                                    <li class="header-submenu__item">
                                                        <a class="header-submenu__link " href="konzerne.html">Konzerne</a>
                                                    </li>

                                            </ul>
                                        </div>

                                    </div>
                                </li>
                                <li class="main-nav__item">
                                    <a class="main-nav__link" href="#">Sign Out</a>
                                </li>
                            </ul>
                        
                        </div>
                    </div>
                </nav>
            </div>
        </header>
        <main>

            <div class="container-fluid" id="app">
                <div class="analytics">             
                    <el-tabs class="analytics-dashbord" v-model="dashboardsValue" type="card" @tab-remove="removeDashbord">
                        <el-tab-pane closable 
                            v-for="(item, index) in dashboards"
                            :key="item.name"
                            :label="item.title"
                            :name="item.name"
                        >
                        <span class="analytics-dashbord__tab-name" slot="label">
 {{item.title}} 
                            <div class="analytics-dashbord__edit-name" @click="editTabName(item.title, index)">
                                edit
                            </div>
                        </span>
{{item.content}} 
                            <div class="charts" v-for="chart in item.charts">
                                <div class="charts__container" ref="test">
                                    <div class="chart__item">
                                        <div class="chart__header">
                                            <ul class="chart-list chart-list--left">
                                                <li class="chart-list__item"  v-bind:class="{ active : chart.isPanelActive }" v-on:click="togglePanel('isPanelActive', index, chart.id)">
                                                    <i class="fas fa-filter"></i>
                                                </li>
                                                <li class="chart-list__item" v-bind:class="{ active : chart.isPanelActive2 }" v-on:click="togglePanel('isPanelActive2', index, chart.id)">
                                                    <i class="fas fa-cog"></i>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="fas fa-sort-amount-down"></i>
                                                    <el-select class="analytics-select" v-model="chartSorting" placeholder="Select">
                                                        <el-option
                                                          v-for="item in chartSortingOptions"
                                                          :key="item.value"
                                                          :label="item.label"
                                                          :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="far fa-chart-bar"></i>
                                                    <el-select class="analytics-select" v-model="chartType" placeholder="Select">
                                                        <el-option
                                                          v-for="item in chartTypeOptions"
                                                          :key="item.value"
                                                          :label="item.label"
                                                          :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </li>
                                            </ul>
                                            <ul class="chart-list chart-list--right">
                                                <li class="chart-list__item">
                                                    <i class="fas fa-download"></i>
                                                </li>
                                                <li class="chart-list__item">
                                                    <i class="fas fa-trash"></i>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="chart__body">
                                            <!-- start panel -->
                                            <div class="chart__panels">
                                                <div class="filters-panel filters-panel--small" v-bind:class="{ active : chart.isPanelActive }">
                                                    <div class="filters-panel__btn" v-bind:class="{ active : chart.isPanelActive }"
                                                    v-if="isPanelActive" v-on:click="togglePanel('isPanelActive1', index, chart.id)">
                                                        <span>&nbsp;</span>
                                                        <span class="collapse-icon-closed">
                                                            <i class="fas fa-chevron-left"></i>
                                                        </span>
                                                        <span class="collapse-icon-open">
                                                            
                                                        </span>
                                                        <span class="search-mobile">
                                                            <i class="fas fa-search"></i>
                                                        </span>
                                                    </div>
                                                    <div class="filters-panel__body">
                                                        <form>
                                                            <!-- SEARCH & FILTER STARTS -->
                                    
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">search & filter
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-7 offset-4">
                                                                            <div class="select-container">
                                                                                <el-select v-model="selectedUserFilter"
                                                                                            placeholder="Select saved filter" 
                                                                                            >
                                                                                    <el-option
                                                                                            v-for="opt in savedUserFilters"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div class="open-icon" aria-expanded="true" v-on:click="openFilterListDlg">
                                                                                <i class="fas fa-cog"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon"
                                                                   aria-expanded="true" data-toggle="collapse" :href="'#textFilterBody' + chart.id"
                                                                   role="tab">
                                                                    <span class="filter-category__title">TEXT & PERIOD FILTER</span>
                                                                    <span class="collapse-icon-closed">
                                                                                        <i class="fas fa-chevron-down"></i>
                                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                                        <i class="fas fa-chevron-up"></i>
                                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show"
                                                                    :id="'textFilterBody' + chart.id" role="tabpanel">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Posted</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateChangeOptions.rangeSeparator == '-'">{{ dateChangeOptions.rangeSeparator }} </span>
                                                                                        <div v-if="dateChangeOptions.rangeSeparator != '-'" style="margin-left: -75px;">{{ dateChangeOptions.rangeSeparator }}</div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                                                        </div>
                                    
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Text Search</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="Search title or message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->


                                                            <!-- EXTENDED TEXT SEARCH START -->
                                                            <div class="filter-category">

                                                                <a class="filter-category__head collapse-icon" aria-controls="extendedTextSearchBody"
                                                                aria-expanded="true" data-toggle="collapse" href="#extendedTextSearchBody"
                                                                id="extendedTextSearch" role="tab">
                                                                    <span class="filter-category__title">Extended text search</span>
                                                                    <span class="collapse-icon-closed">
                                                                        <i class="fas fa-chevron-down"></i>
                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                        <i class="fas fa-chevron-up"></i>
                                                                    </span>
                                                                </a>

                                                                <div class="filter-category__body collapse show" aria-labelledby="extendedTextSearch"
                                                                    id="extendedTextSearchBody" role="tabpanel">
                                                                    <div class="filter-category__section"
                                                                        v-for="(extItem, extIndex) in filter.extendedKeywords">
                                                                        <div class="filter-category__item" v-if="extIndex > 0">
                                                                            <el-radio-group v-model="extItem.blockCondition"
                                                                                            class="radio-group radio-group--main">
                                                                                <el-radio-button label="And">
                                                                                    And
                                                                                </el-radio-button>
                                                                                <el-radio-button label="Or">
                                                                                    Or
                                                                                </el-radio-button>
                                                                                <el-radio-button label="Exclude">
                                                                                    Exclude
                                                                                </el-radio-button>
                                                                            </el-radio-group>

                                                                        </div>

                                                                        <div class="[ row no-gutters ]  filter-category__item">
                                                                            <div class="col-4">
                                                                                <label class="filter-category__label">Field</label>
                                                                            </div>

                                                                            <div class="col-7">
                                                                                <div class="select-container">
                                                                                    <el-select v-model="extItem.fieldName"
                                                                                                placeholder="">
                                                                                            <el-option
                                                                                                    v-for="opt in fieldNames"
                                                                                                    :label="opt.label"
                                                                                                    :key="opt.fieldName"
                                                                                                    :value="opt.fieldName">
                                                                                            </el-option>
                                                                                    </el-select>
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <div class="[ row no-gutters ] filter-category__item">
                                                                            <div class="col-7 offset-4">
                                                                                <el-radio-group v-model="extItem.containsCond" class="radio-group">
                                                                                    <el-radio-button label="Contains">
                                                                                        Contains
                                                                                    </el-radio-button>
                                                                                    <el-radio-button label="Not_contains">
                                                                                        Not contains
                                                                                    </el-radio-button>
                                                                                </el-radio-group>

                                                                            </div>
                                                                        </div>

                                                                        <div class="[ row no-gutters ]  filter-category__item">
                                                                            <div class="col-4">
                                                                                <label class="filter-category__label">Search term</label>
                                                                            </div>

                                                                            <div class="col-7">
                                                                                <input type="text" class="cims-input filter-category__control"
                                                                                    v-model="extItem.keyword">
                                                                            </div>
                                                                        </div>
                                                                        <div class="filter-category__item category-control category-control--plus">
                                                                            <a href="javascript:void(0)" class="btn-link filter-btn"
                                                                            v-on:click="addExtendedKeyword(extIndex)">
                                                                                <i class="fas fa-plus-square"></i>
                                                                                Add extended group
                                                                            </a>
                                                                            <a href="javascript:void(0)" class="btn-link filter-btn"
                                                                            v-on:click="removeExtendedKeyword(extIndex)">
                                                                                <i class="fas fa-minus-square"></i>
                                                                                Remove extended group
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- EXTENDED TEXT SEARCH ENDS -->


                                                            <!-- CATEGORY FILTER START -->
                                                            <div class="filter-category">

                                                                <a class="filter-category__head collapse-icon" aria-controls="categoryFilterBody"
                                                                aria-expanded="true" data-toggle="collapse" href="#categoryFilterBody"
                                                                id="categoryFilter" role="tab">
                                                                    <span class="filter-category__title">Category filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                        <i class="fas fa-chevron-down"></i>
                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                        <i class="fas fa-chevron-up"></i>
                                                                    </span>
                                                                </a>
                                    
                                                                <div class="filter-category__body collapse show" aria-labelledby="categoryFilter"
                                                                    id="categoryFilterBody" role="tabpanel">
                                                                    <div v-for="(catBlock, catBlockIndex) in filter.categoryBlocks"
                                                                        class="filter-category__section">
                                                                        <div class="filter-category__item">
                                                                            <div class="filter-category__item" v-if="catBlockIndex > 0">
                                                                                <el-radio-group v-model="catBlock.blockCondition"
                                                                                                class="radio-group radio-group--main">
                                                                                    <el-radio-button label="And">And
                                                                                    </el-radio-button>
                                                                                    <el-radio-button label="Or">Or
                                                                                    </el-radio-button>
                                                                                    <el-radio-button label="Exclude">
                                                                                        Exclude
                                                                                    </el-radio-button>
                                                                                </el-radio-group>
                                    
                                                                            </div>
                                                                        </div>
                                    
                                                                        <div class="[ row no-gutters ]  filter-category__item">
                                                                            <div class="col-4">
                                                                                <label class="filter-category__label">Category</label>
                                                                            </div>
                                                                            <div class="col-7">
                                                                                <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                    <el-autocomplete
                                                                                            v-model="categorySearchResult"
                                                                                            value-key="name"
                                                                                            placeholder="Search category"
                                                                                            :trigger-on-focus="false"
                                                                                            @select="selectPlainCategory"
                                                                                    ></el-autocomplete>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-1">
                                                                                <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                    <i class="fas fa-folder"></i>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                    
                                                                        <div class="[ row no-gutters ] filter-category__item">
                                                                            <div class="col-7 offset-4">
                                                                                <el-radio-group v-model="catBlock.categoryCondition" class="radio-group"
                                                                                                >
                                                                                    <el-radio-button label="And">And
                                                                                    </el-radio-button>
                                                                                    <el-radio-button label="Or">Or
                                                                                    </el-radio-button>
                                                                                </el-radio-group>
                                    
                                                                            </div>
                                                                        </div>
                                    
                                                                        <div class="filter-category__item">
                                                                            <ul class="category category--unrating">
                                                                                <li v-for="(cat, index) in catBlock.categories"
                                                                                    v-if="cat.visibility"
                                                                                    :class="'category__item category__item--' + ((cat.ratingCategory == true)?'rating':'unrating')">
                                                                                    <span class="category__delete"
                                                                                        v-on:click="removeFilterCategory(catBlockIndex, cat.id)">&#10006;</span>
                                                                                    <span class="category__type"><i class="icon-tag"></i></span>
                                                                                    <span class="category__name">{{ cat.name }} </span>
                                                                                </li>
                                                                            </ul>
                                                                           
                                                                        </div>
                                                                        <div class="filter-category__item category-control category-control--plus">
                                                                            <a href="javascript:void(0)" class="btn-link filter-btn"
                                                                            v-on:click="addCategoryBlock(catBlockIndex)">
                                                                                <i class="fas fa-plus-square"></i>
                                                                                Add filter group
                                                                            </a>
                                                                            <a href="javascript:void(0)" class="btn-link filter-btn"
                                                                            v-on:click="removeCategoryBlock(catBlockIndex)">
                                                                                <i class="fas fa-minus-square"></i>
                                                                                Remove filter group
                                                                            </a>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- CATEGORY FILTER END -->



                                                            <!-- ADMIN FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="adminFilterBody"
                                                                aria-expanded="true" data-toggle="collapse" href="#adminFilterBody" id="adminFilter"
                                                                role="tab">
                                                                    <span class="filter-category__title">Admin filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                        <i class="fas fa-chevron-down"></i>
                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                        <i class="fas fa-chevron-up"></i>
                                                                    </span>
                                                                </a>
                                                                <div class="filter-category__body collapse show" aria-labelledby="adminFilter"
                                                                    id="adminFilterBody" role="tabpanel">
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                        v-if="userActions.FILTER_BY_DATE_CREATE === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Created</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateCreateRange"
                                                                                        type="daterange"
                                                                                        language="en"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateCreateOptions"
                                                                                        :format="dateCreateOptions.dateInFormat"
                                                                                        v-on:change="dateCreateOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateCreateOptions.rangeSeparator == '-'">{{ dateCreateOptions.rangeSeparator }}</span>
                                                                                        <div v-if="dateCreateOptions.rangeSeparator != '-'"
                                                                                            style="margin-left: -60px;">{{ dateCreateOptions.rangeSeparator
                                                                                            }} 
                                                                                        </div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                    
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                        v-if="userActions.FILTER_BY_DATE_CHANGE === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Changed</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container select-container--icon-right">
                                                                                <el-date-picker
                                                                                        v-model="filter.dateChangeRange"
                                                                                        type="daterange"
                                                                                        language="de"
                                                                                        start-placeholder="Start date"
                                                                                        end-placeholder="End date"
                                                                                        :default-time="['00:00:00', '23:59:59']"
                                                                                        unlink-panels
                                                                                        :picker-options="dateChangeOptions"
                                                                                        :format="dateChangeOptions.dateInFormat"
                                                                                        v-on:change="dateChangeOptions.onChange($event)">
                                                                                    <template v-slot:range-separator>
                                                                                        <span v-if="dateCreateOptions.rangeSeparator == '-'">{{ dateCreateOptions.rangeSeparator }}</span>
                                                                                        <div v-if="dateCreateOptions.rangeSeparator != '-'"
                                                                                            style="margin-left: -60px;">{{ dateCreateOptions.rangeSeparator
                                                                                            }} 
                                                                                        </div>
                                                                                    </template>
                                                                                </el-date-picker>
                                                                            </div>
                                    
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ]  filter-category__item"
                                                                        v-if="userActions.FILTER_BY_STATUS === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">msg status</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="filter.statusId"
                                                                                            placeholder="Any">
                                                                                        <el-option
                                                                                                label="Any"
                                                                                                :value="0"
                                                                                                :key="0"
                                                                                                >
                                                                                        </el-option>
                                                                                        <el-option
                                                                                                v-for="item in cimsStatuses"
                                                                                                :selected="item.id === filter.statusId ? true : false"
                                                                                                :label="item.name"
                                                                                                :key="item.id"
                                                                                                :value="item.id">
                                                                                        </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ]  filter-category__item"
                                                                        v-if="userActions.FILTER_BY_FEED === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Feed</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="filter.feedId">
                                                                                        <el-option
                                                                                                label="Any"
                                                                                                :value="0"
                                                                                                :key="0"
                                                                                                >
                                                                                        </el-option>
                                                                                        <el-option
                                                                                                v-for="item in feeds"
                                                                                                :label="item.name"
                                                                                                :key="item.id"
                                                                                                :value="item.id">
                                                                                        </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                        v-if="userActions.FILTER_BY_USER === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">User</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select
                                                                                        v-model="filter.userIds"
                                                                                        multiple
                                                                                        filterable
                                                                                        collapse-tags
                                                                                        placeholder="Select users">
                                                                                    <el-option
                                                                                            v-for="item in users"
                                                                                            :key="item.userId"
                                                                                            :label="item.screenName"
                                                                                            :value="item.userId">
                                                                                        <span>{{ item.screenName }} </span>
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- ADMIN FILTER END -->

                                                            <div class="filter-category">
                                                                <a class="filter-category__head collapse-icon" aria-controls="miscellanousFilterBody"
                                                                    aria-expanded="true" data-toggle="collapse" href="#miscellanousFilterBody"
                                                                    id="miscellanousFilter" role="tab">
                                                                    <span class="filter-category__title">Miscellaneous filter</span>
                                                                    <span class="collapse-icon-closed">
                                                                        <i class="fas fa-chevron-down"></i>
                                                                    </span>
                                                                    <span class="collapse-icon-open">
                                                                        <i class="fas fa-chevron-up"></i>
                                                                    </span>
                                                                </a>
                                    
                                                                <div class="filter-category__body collapse show" aria-labelledby="miscellanousFilter"
                                                                        id="miscellanousFilterBody" role="tabpanel">
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                            v-if="userActions.FILTER_BY_WORKFLLOW_STATUS === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Status</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="filter.workflowStatusId">
                                                                                        <el-option
                                                                                                label="Any"
                                                                                                :value="0"
                                                                                                :key="0"
                                                                                                >
                                                                                        </el-option>
                                                                                        <el-option
                                                                                                v-for="item in workflowStatuses"
                                                                                                :label="item.name"
                                                                                                :key="item.id"
                                                                                                :value="item.id">
                                                                                        </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                            v-if="userActions.FILTER_BY_SOURCE === true">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Source</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <input type="text" autocomplete="off"
                                                                                        class="cims-input filter-category__control dropdown-toggle"
                                                                                        readonly value="Source"
                                                                                        placeholder="select_source"
                                                                                        id="source-input" data-toggle="dropdown"
                                                                                        v-model="filter.source.name">
                                                                                <div ref="dropdownSource" class="dropdown-menu dropdown-tree" id="source"
                                                                                        aria-labelledby="source-input">
                                                                                    <el-tree
                                                                                            :data="sourceTree"
                                                                                            :props="sourceTreeProps"
                                                                                            highlight-current
                                                                                            :expand-on-click-node="false"
                                                                                            @node-click="onSourceNodeClick"
                                                                                            ref="treeResources">
                                                                                        <span class="el-tree__wrapper" slot-scope="{ node, data }"></span>
                                                                                    </el-tree>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab" v-on:click="selectSource()">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item"
                                                                            v-if="userActions.FILTER_BY_VIEWS === true" :key="uiViewsKey">
                                                                        <div class="col-4">&nbsp;</div>
                                                                        <div class="col-7 slider-range-views">
                                                                            <input type="text" v-model="filterMinViews"/>
                                                                            <input type="text" v-model="filterMaxViews"/>
                                                                        </div>
                                    
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Views</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <el-slider
                                                                                    v-model="filter.views"
                                                                                    range
                                                                                    :show-tooltip="true"
                                                                                    :max="viewsMax"
                                                                                    :min="viewsMin">
                                                                            </el-slider>
                                                                        </div>
                                    
                                                                        <div class="col-4">&nbsp;</div>
                                                                        <div class="col-7 slider-range-views">
                                                                            <span></span>
                                                                            <span></span>
                                                                        </div>
                                    
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link" value="save" v-on:click="openFilterDlg">
                                                                    <i class="fas fa-save"></i>
                                                                    save_filter
                                                                </a>
                                                            </div>
                                    
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link" value="reset"
                                                                   v-on:click="clearFilters($event)">
                                                                    <i class="far fa-trash-alt"></i>
                                                                    reset
                                                                </a>
                                                                <a href="javascript:void(0)" class="btn-link btn-link--primary"
                                                                   v-on:click="doSearch($event)">
                                                                    <i class="fas fa-search"></i>
                                                                    submit
                                                                </a>
                                                            </div>
                                    
                                                        </form>
                                                    </div>
                                                </div>
                                                <!-- ends panel -->
                                                <div class="filters-panel filters-panel--small" v-bind:class="{ active : chart.isPanelActive2 }">
                                                    <div class="filters-panel__body">
                                                        <form>
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Breakdown by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Select categories to be shown on the Y-Axis:</p>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Breakdown"
                                                                            inactive-text="Summarize">
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Category</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>

                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Sort by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.typeSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.typeSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.viewSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.viewSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.orderSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.orderSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.value"
                                                                                            :value="opt.value">
                                                                                    </el-option>
                                                                            </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">List Results (0 = All):</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <el-input v-model="yAxis.linitResults" class="full-width input-small"></el-input>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">What to count?</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue"
                                                                                            >
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Delta vs. previous period"
                                                                            >
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Limit count to the following categories:</p>
                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Chart title</p>
                                                                    <div class="filter-category__item">
                                                                        <el-input v-model="yAxis.linitResults" placeholder="Title" class="full-width input-small"></el-input>
                                                                    </div>
                                                                    <div class="filter-category__item">
                                                                        <el-input v-model="yAxis.linitResults" placeholder="Subtitle" class="full-width input-small"></el-input>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        
                                                            <div class="btn-container btn-container--center">
                                                                <a href="javascript:void(0)" class="btn-link btn-link--primary"
                                                                   v-on:click="doSearch($event)">
                                                                    <i class="fas fa-search"></i>
                                                                    submit
                                                                </a>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="chart-container" v-bind:style="chart.chartHeight" :ref="'settingsBox' + chart.id" v-bind:class="{ active: chart.isPanelActive2 || chart.isPanelActive }">

                                                <highcharts :ref="'myChart' + chart.id" class="chart__graph" :options="options" ref="highcharts"></highcharts>

                                            </div>
                                            <div class="chart__panels chart__panels--bottom" >
                                                <div class="filters-panel filters-panel--bottom" :ref="'panelBottom' + chart.id" v-bind:class="{ active: chart.isPanelActive2 }">
                                                    <div class="filters-panel__body">
                                                        <form class="form-inline">
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Breakdown by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="filter-category">
                                                                <div class="filter-category__title">Y-Axis
                                                                </div>
                                                                <div class="filter-category__body">

                                                                            <label class="filter-category__label">Breakdown by:</label>


                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.breakdownValue" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.breakdown"
                                                                                            :label="opt.name"
                                                                                            :key="opt.id"
                                                                                            :value="opt.name">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>


                                                                </div>
                                                            </div>
                                                            <!-- SEARCH & FILTER END -->
                                    
                                                            <!-- TEXT & PERIOD FILTER STARTS -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body collapse show" aria-labelledby="textFilter"
                                                                     id="textFilterBody" role="tabpanel">
                                                                    <p>Select categories to be shown on the Y-Axis:</p>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <el-switch
                                                                            v-model="yAxis.toggleControl"
                                                                            active-text="Breakdown"
                                                                            inactive-text="Summarize">
                                                                        </el-switch>
                                                                        
                                                                    </div>
                                    
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">Category</label>
                                                                        </div>
                                    
                                                                        <div class="col-7">
                                                                            <input type="text" class="cims-input filter-category__control"
                                                                                   placeholder="search_title_or_message" v-model="filter.keywords">
                                                                        </div>
                                                                    </div>

                                                                    <div class="[ row no-gutters ]  filter-category__item">
                                                                        <div class="col-4">
                                                                            <label class="filter-category__label">category</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div aria-expanded="true" class="input-container"
                                                                                    v-on:click="setCategoryBlockIndex(catBlockIndex)">
                                                                                <el-autocomplete
                                                                                        v-model="yAxis.categorySearchResult"
                                                                                        value-key="name"
                                                                                        placeholder="search_category"
                                                                                        :trigger-on-focus="false"
                                                                                        
                                                                                ></el-autocomplete>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-1">
                                                                            <div aria-expanded="true"
                                                                                    class="open-icon" role="tab"
                                                                                    v-on:click="selectCategory(catBlockIndex)">
                                                                                <i class="fas fa-folder"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- TEXT & PERIOD FILTER END -->
                                                            <div class="filter-category">
                                                                <div class="filter-category__body">
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-5">
                                                                            <label class="filter-category__label">List Results (0 = All):</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <el-input v-model="yAxis.linitResults" class="full-width input-small"></el-input>
                                                                        </div>
                                                                    </div>
                                                                    <div class="[ row no-gutters ] filter-category__item">
                                                                        <div class="col-5">
                                                                            <label class="filter-category__label">Sort by:</label>
                                                                        </div>
                                                                        <div class="col-7">
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.typeSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.typeSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.viewSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.viewSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.id"
                                                                                            :value="opt.label">
                                                                                    </el-option>
                                                                                </el-select>
                                                                            </div>
                                                                            <div class="select-container">
                                                                                <el-select v-model="yAxis.orderSorting" placeholder="Select">
                                                                                    <el-option
                                                                                            v-for="opt in yAxis.orderSortingOptions"
                                                                                            :label="opt.label"
                                                                                            :key="opt.value"
                                                                                            :value="opt.value">
                                                                                    </el-option>
                                                                            </el-select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </el-tab-pane>
                        <el-tab-pane  v-if="dashboards.length !== 0" :name="`${(tabIndex + 1).toString()}`"> 
                                <span class="add-test" slot="label" @click="addNewDashbord(tabIndex)">
                                    <i class="far fa-plus-square"></i>
                                </span>
                        </el-tab-pane>
                    </el-tabs>

                    <div class="btn-analytics" @click="addNewDashbord(dashboardsValue)"><span class="btn-analytics__title">Add chart</span></div>

                </div>

                <el-dialog title="Category popup" :visible.sync="dlgTabName"
                           custom-class="category-popup">
                    <div class="dialog-body">
                        <el-input
                            class="input-small"
                            v-model="editTitle"
                        ></el-input>
                    </div>
                    <div slot="footer" class="dialog-footer">
                        <el-button size="small" @click="dlgTabName = false">
                            Cancel
                        </el-button>
                        <el-button size="small" type="primary" @click="saveTabName">
                            Confirm
                        </el-button>
                    </div>
                </el-dialog>
            </div>


        </main>

        <footer class="footer">
            <div class="container-fluid">
                <p class="footer__copyright">© Copyright 2018 Consline AG</p>
            </div>
        </footer>
        
    </div>


    <!-- SCRIPTS -->
 
<script type="text/babel">

class DateRangePickerOptions {
    constructor() {
        this.dateInCalcRule = -1;
        this.dateInFormat = 'dd.MM.yyyy';
        this.rangeSeparator = '-';
        var thisObj = this;

        this.onPick = function (dates) {
            thisObj.dateInCalcRule = -1;
            thisObj.rangeSeparator = '-';
            thisObj.dateInFormat = 'dd.MM.yyyy';
        };

        this.shortcuts = [
            {
                text: 'Last 7 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 7;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 7 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last 14 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 14;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 14 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last 30 days',
                onClick(picker) {
                    thisObj.dateInCalcRule = 30;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = '.';
                    thisObj.rangeSeparator = 'Last 30 days';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Month',
                onClick(picker) {
                    thisObj.dateInCalcRule = 31;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Quarter',
                onClick(picker) {
                    thisObj.dateInCalcRule = 90;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }, {
                text: 'Last Year',
                onClick(picker) {
                    thisObj.dateInCalcRule = 365;
                    let arange = DateRangePickerOptions.calcRangeByRule(thisObj.dateInCalcRule, null, null);
                    thisObj.dateInFormat = 'dd.MM.yyyy';
                    thisObj.rangeSeparator = '-';
                    picker.$emit('pick', arange);
                }
            }
        ];
    }

    static calcRangeByRule(prmCalcRule, prmMinDefault, prmMaxDefault) {
        switch (prmCalcRule) {
            case -1: return [ prmMinDefault, prmMaxDefault ];
            case 365: {
                var targetYear = new Date();
                targetYear.setFullYear(targetYear.getFullYear() - 1);
                var startDate = new Date(targetYear.getFullYear(), 0, 1);
                var endDate = new Date(targetYear.getFullYear(), 12, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 90: {
                var targetMonth = new Date();
                targetMonth.setMonth(targetMonth.getMonth() - 3);
                var targetQuater = parseInt((targetMonth.getMonth() + 1) / 3) + 1;
                var startDate = new Date(targetMonth.getFullYear(), 0 + (targetQuater - 1) * 3, 1);
                var endDate = new Date(targetMonth.getFullYear(), 3 + (targetQuater - 1) * 3, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 31: {
                var targetMonth = new Date();
                targetMonth.setMonth(targetMonth.getMonth() - 1);
                var startDate = new Date(targetMonth.getFullYear(), targetMonth.getMonth(), 1);
                var endDate = new Date(targetMonth.getFullYear(), targetMonth.getMonth() + 1, 0);
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 0);
                return [startDate, endDate];
            };
            case 30: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 29);
                return [date, now];
            };
            case 14: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 13);
                return [date, now];
            };
            case 7: {
                var now = new Date();
                const date = new Date();
                date.setHours(0, 0, 0, 0);
                date.setTime(date.getTime() - 3600 * 1000 * 24 * 6);
                return [date, now];
            }
        }
    }

    onChange (e) {
        if (e == null) {
            this.rangeSeparator = '-';
            this.dateInFormat = 'dd.MM.yyyy';
        } else {

        }
        console.log('changed');
    }
}






var options = {
    title: {
        text: 'Title of this chart'
        },
    legend: {
    enabled: false
    },
    credits: {
    enabled: false
    },
    tooltip: {
    positioner: function(labelWidth, labelHeight, point) {
        var seriesPoints = this.chart.series[0].points,
        indexValue, tooltipX, tooltipY;

        seriesPoints.forEach(function(el, inx) {
        if ((point.plotX === Math.round(el.plotX)) && (point.plotY === Math.round(el.plotY))) {
            indexValue = inx;
        }
        });

        tooltipX = point.plotX;
        tooltipY = this.chart.chartHeight - this.chart.plotTop - this.chart.xAxis[0].bottom;

        if (indexValue === 0) {
        tooltipX += this.chart.plotLeft;
        }

        return {
        x: tooltipX,
        y: tooltipY
        };
    },
    shadow: false,
    borderWidth: 1,
    backgroundColor: 'rgba(255,255,255,0.8)'
    },
    xAxis: {
    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },
    series: [{
    data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
    }],
    //exporting: {
    //    showTable: true
    //}
}
Vue.use(VueHighcharts);

new Vue({
    el: "#app",
    data: function() {
        return {
            selectedUserFilter: '',
            savedUserFilters: [{name: 'filter1', id: 1},{name: 'filter2', id: 2},{name: 'filter3', id: 3}],

            chartSorting: '',
            chartSortingOptions: [{label: 'Sort by categories (ascending)', value: 'cat,asc'}, {label: 'Sort by categories (descending)', value: 'cat,desc'},
                {label: 'Sort by total (ascending)', value: 'total,asc'}, {label: 'Sort by total (descending)', value: 'total,desc'},
                {label: 'Sort by negatives (ascending)', value: 'negatives,asc'}, {label: 'Sort by negatives (descending)', value: 'negatives,desc'},
                {label: 'Sort by neutrals (ascending)', value: 'neutrals,asc'}, {label: 'Sort by neutrals (descending)', value: 'neutrals,desc'},
                {label: 'Sort by positives (ascending)', value: 'positives,asc'}, {label: 'Sort by positives (descending)', value: 'positives,desc'},
            ],
            chartType: '',
            chartTypeOptions: [{label: 'Column Chart', value: 'column_chart'}, {label: 'Percentage Chart', value: 'percentage_chart'},
                {label: 'Bar Chart', value: 'bar_chart'}, {label: 'Bar Chart (Percentage)', value: 'bar_chart_percentage'},
                {label: 'Pie Chart', value: 'pie_chart'}, {label: 'Data table', value: 'data_table'},
            ],

            options: options,
            panels: ['isPanelActive', 'isPanelActive2'],
            isPanelActive: false,
            isPanelActive2: true,
            xAxis: {

            },
            yAxis: {
                breakdown: [{name: 'Tonality', id: 1},{name: 'Categories', id: 2},{name: 'Total', id: 3},{name: 'Worldmap', id: 4},],
                breakdownValue: '',
                toggleControl: '',
                linitResults: '',
                typeSorting: '',
                typeSortingOptions: [{label: "Category", id: 1}, {label: "Total", id: 2}, {label: "Positive", id: 3}, {label: "Neutral", id: 4}, {label: "Negative", id: 5}],
                viewSorting: '',
                viewSortingOptions: [{label: "Absolute", id: 1}, {label: "Relative / Percentage", id: 2}],
                orderSorting: '',
                orderSortingOptions: [{label: "Descending", value: "desc"}, {label: "Ascending", value: "asc"},],
            },
            filter: {
                categoryBlocks: [{
                    blockCondition: "And",
                    categories: [
                        {
                            id: 1944,
                            name: "Alerts",
                            parentCategory: ['CIMS'],
                            ratingCategory: false,
                            visibility: true
                        },
                        {
                            id: 4026,
                            name: "Accident",
                            parentCategory: ['CIMS', 'Alerts'],
                            ratingCategory: false,
                            visibility: true
                        },
                    ],
                    categoryCondition: "And",
                }],
                dateChangeRange: ["", ""],
                dateCreateRange: ["", ""],
                dateInRange: ["", ""],
                extendedKeywords: [
                    {
                        blockCondition: "And",
                        containsCond: true,
                        fieldName: "",
                        keyword: "",
                    }
                ],
                feedId: 0,
                keywords: "",
                reseted: 0,
                source: {
                    id: 0,
                    name: "",
                },
                statusId: 0,
                userIds: [],
                views: [0, 20202]
            },
            fieldNames: [
                {
                    fieldName: "title",
                    label: "Original title"
                },
                {
                    fieldName: "titleTransl",
                    label: "Translated title"
                },
                {
                    fieldName: "shorttext",
                    label: "Short description original"
                },
                {
                    fieldName: "shorttextTransl",
                    label: "Short description translated"
                }
            ],
            categorySearchResult: '',
            userActions: {
                FILTER_BY_DATE_CREATE: true,
                FILTER_BY_DATE_CHANGE: true,
                FILTER_BY_STATUS: true,
                FILTER_BY_FEED: true,
                FILTER_BY_USER: true,
                FILTER_BY_WORKFLLOW_STATUS: true,
                FILTER_BY_SOURCE: true,
            },
            cimsStatuses: [
                {
                    id: 1,
                    name: "New Messages",
                },
                {
                    id: 2,
                    name: "Unpublished",
                },
                {
                    id: 3,
                    name: "Published"
                }
            ],
            feeds: [
                {
                    id: 2,
                    name: "qwerty",
                    newMessages: 0,
                    organizationId: 28027,
                }
            ],
            users: [
                {
                    email: "schachtner@consline.com",
                    firstName: "Dirk",
                    lastName: "Schachtner",
                    middleName: "",
                    screenName: "schachtner@consline.com",
                    userId: 10644,
                },
                {
                    email: "van.deelen@consline.com",
                    firstName: "Heinz",
                    lastName: "van Deelen",
                    middleName: "",
                    screenName: "deelen",
                    userId: 12616,
                },
            ],

            workflowStatuses: [
                {
                    id: 78,
                    name: "Open",
                    organizationid: 28027,
                },
                {
                    id: 131,
                    name: "In Progress",
                    organizationid: 28027,
                },
                {
                    id: 184,
                    name: "Resolved",
                    organizationid: 28027,
                },
                {
                    id: 237,
                    name: "Reopened",
                    organizationid: 28027,
                },
                {
                    id: 290,
                    name: "Closed",
                    organizationid: 28027,
                },
                {
                    id: 337,
                    name: "tested",
                    organizationid: 28027,
                },
            ],








            dateInOptions: new DateRangePickerOptions(),
            dateCreateOptions: new DateRangePickerOptions(),
            dateChangeOptions: new DateRangePickerOptions(),
            tabIndex: 0,
            dlgTabName: false,
            editTitle: '',
            editTitleIndex: null,

            dashboardsValue: '1',
            dashboards: [
                {
                    title: 'New Chart 1',
                    name: '1',
                    content: 'New Chart 1',
                    charts: [
                        {
                            id: 1,
                            panels: ['isPanelActive', 'isPanelActive2'],
                            isPanelActive: true,
                            isPanelActive2: false,
                            chartHeight: {},
                        }
                    ]
                },
            ],
            tabIndex: 1
        }
    },
    methods: {
        addNewDashbord: function(targetName) {
            console.log(this.tabIndex)
            let newDashbordName = ++this.tabIndex + '';
            const title = `New chart ${this.tabIndex}`
            this.dashboards.push({
                title: title,
                name: newDashbordName,
                content: 'New Tab content',

            });
            
            this.dashboardsValue = newDashbordName;
        },
        removeDashbord: function(targetName) {
            let tabs = this.dashboards;
            let activeName = this.dashboardsValue;
            console.log(targetName, activeName)
            if (activeName === targetName) {
                tabs.forEach((tab, index) => {
                    if (tab.name === targetName) {
                        console.log(tab.name)
                        let nextTab = tabs[index + 1] || tabs[index - 1];
                        if (nextTab) {
                            activeName = nextTab.name;
                        }
                    }
                });
            }
            
            this.dashboardsValue = activeName;
            this.dashboards = tabs.filter(tab => tab.name !== targetName);
        },
        editTabName: function(name,index) {
            console.log(name)
            this.editTitle = name;
            this.editTitleIndex = index;
            this.dlgTabName = true;
        },
        saveTabName: function() {
            this.dashboards[this.editTitleIndex].title = this.editTitle;
            console.log(this.editTitleIndex)
            this.dlgTabName = false;
            document.getElementById(`tab-${this.editTitleIndex + 1}`).focus()
        },
        openFilterListDlg: function() {
            console.log('1')
        },
        openFilterDlg: function() {
            console.log(1)
        },
        togglePanel: function(panelName, dashboardIndex, chartIndex) {
            const currentChart =  this.dashboards[dashboardIndex].charts[1 - chartIndex];
            const box = this.$refs[`settingsBox${chartIndex}`][0];
            const chartBox = this.$refs[`myChart${chartIndex}`][0];
            console.log(box, chartBox)
            const chart = chartBox.chart;
            const bottomPanel = this.$refs[`panelBottom${chartIndex}`][0];
            console.log(bottomPanel)
            currentChart.panels.forEach((function(e) {
                if (e === panelName) {
                    currentChart[panelName] = !currentChart[panelName]
                } else {
                    currentChart[e] = false
                    
                }
            }).bind(this))
            console.log(bottomPanel.clientHeight)
            let panelHeight
            const that = this

            setTimeout(function() {
                /*const heightString = that.$refs.settingsBox[0].clientWidth;
                that.$refs.myChart[0].chart.setSize(null, 300)*/
                if (currentChart.isPanelActive2) {
                    panelHeight = bottomPanel.clientHeight;
                    console.log(box)
                    Vue.set(currentChart.chartHeight, 'height', `495px`);
                    chart.setSize(null, null)
                } else {
                    Vue.set(currentChart.chartHeight, 'height', '100%');
                    chart.setSize(null, null)
                }
                const heightString = box.clientWidth
                
                
            }, 400)
        },
        selectPlainCategory: function() {
            console.log(1)
        }
    }
}); 
    </script>
    <script src="js/main.js"></script>
</body>
</html>